# تعليمات تصدير الطلبات - نظام المبيعات

## نظرة عامة
تم تحديث نظام تصدير الطلبات ليتوافق مع المتطلبات المطلوبة لشركة الشحن.

## كيفية التصدير

### 1. الوصول لصفحة الطلبات
- اذهب إلى صفحة "الطلبات" من القائمة الجانبية
- ستجد زر "تصدير الطلبات (XLS)" في قسم الفلاتر

### 2. تحديد التاريخ
- اضغط على زر التصدير
- اختر التاريخ المطلوب (افتراضي: اليوم الحالي)
- النظام يصدر تلقائياً بصيغة XLSX

### 3. تأكيد التصدير
- اضغط على "تصدير" لتأكيد العملية
- سيتم تحميل الملف تلقائياً

## تنسيق الملف المُصدّر

### ترتيب الأعمدة (من اليسار لليمين):

1. **ملاحظات** - ملاحظات الطلب (إن وجدت)
2. **عدد القطع أجباري** - كمية المنتج المطلوبة
3. **ارجاع بضاعة؟** - دائماً "NO"
4. **هاتف المستلم أجباري 11 خانة** - رقم هاتف العميل
5. **تفاصيل العنوان أجباري** - عنوان التوصيل
6. **شفرة المحافظة أجباري** - كود المحافظة
7. **أسم المستلم** - اسم العميل
8. **المبلغ عراقي كامل بالالاف** - إجمالي المبلغ (0 إذا لم يتوفر)
9. **رقم الوصل** - دائماً فارغ (سيتم توليده من النظام)

## ملاحظات مهمة

- يتم تصدير الطلبات حسب التاريخ المحدد فقط
- العمود الثالث "ارجاع بضاعة؟" يكون دائماً "NO"
- العمود التاسع "رقم الوصل" يكون دائماً فارغ
- الملف يُحفظ في مجلد `exports` في النظام
- صيغة XLS مطلوبة للتوافق مع أنظمة الشحن
- النظام يحفظ بصيغة XLSX مباشرة. يمكنك تحويل الملف إلى XLS باستخدام أي برنامج تحويل أو Excel

## كيفية تحويل XLSX إلى XLS

### الطريقة الأولى: باستخدام Excel
1. افتح الملف XLSX في Excel
2. اضغط على "ملف" → "حفظ باسم"
3. اختر "Excel 97-2003 Workbook (*.xls)"
4. احفظ الملف

### الطريقة الثانية: باستخدام برامج تحويل مجانية
- **Online-Convert.com**: موقع مجاني لتحويل الملفات
- **Convertio.co**: موقع آخر لتحويل الملفات
- **Zamzar.com**: موقع سهل الاستخدام

### الطريقة الثالثة: باستخدام برامج سطح المكتب
- **LibreOffice Calc**: برنامج مجاني ومفتوح المصدر
- **WPS Office**: بديل مجاني لـ Microsoft Office

## استكشاف الأخطاء

### إذا لم تظهر أي طلبات:
- تأكد من أن التاريخ صحيح
- تأكد من وجود طلبات مسجلة لهذا اليوم
- تحقق من قاعدة البيانات

### إذا فشل التصدير:
- تأكد من أن جميع البيانات المطلوبة موجودة
- تحقق من صلاحيات الكتابة في مجلد `exports`
- تأكد من تثبيت مكتبات Python المطلوبة

## المتطلبات التقنية

- Python 3.7+
- pandas
- openpyxl (لإنشاء ملفات XLSX)
- Flask
- SQLAlchemy
